<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Afnan Haute Craft — دخول محمي</title>

  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">

  <style>
    :root { --accent1: #6a00f4; --accent2: #b5179e; --accent3: #7209b7; }
    *{box-sizing:border-box}
    body {
      margin: 0;
      padding: 0;
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      background: linear-gradient(135deg, var(--accent1), var(--accent2), var(--accent3), #f72585);
      background-size: 300% 300%;
      animation: gradientMove 10s ease infinite;
      font-family: 'Cairo', sans-serif;
      color: #fff;
      text-align: center;
    }
    @keyframes gradientMove {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .card {
      background: rgba(0,0,0,0.36);
      padding: 36px;
      border-radius: 16px;
      width: 92%;
      max-width: 520px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.35);
      backdrop-filter: blur(8px);
    }

    .logo {
      width: 160px;
      max-width: 60%;
      margin: 0 auto 18px;
      border-radius: 12px;
      display:block;
    }

    h1 { margin: 6px 0 12px; font-size: 28px; }
    p.lead { margin: 0 0 18px; font-size: 16px; line-height: 1.6; color: #f0e9ff; }

    input[type="password"]{
      width:100%;
      padding: 12px 14px;
      border-radius: 10px;
      border: none;
      font-size: 16px;
      margin: 10px 0;
    }

    .btn {
      display:inline-block;
      padding: 12px 26px;
      margin-top:6px;
      background: linear-gradient(90deg, #b5179e, #7209b7);
      color: #fff;
      text-decoration: none;
      border-radius: 10px;
      font-weight: 700;
      cursor: pointer;
      border: none;
      font-size: 16px;
    }

    .msg { margin-top:12px; min-height:18px; font-weight:600; }

    .small { margin-top:10px; font-size:13px; color: rgba(255,255,255,0.8); }

    @media (max-width:480px){
      h1{font-size:22px}
      .card{padding:22px}
    }
  </style>
</head>
<body>
  <div class="card" role="main" aria-labelledby="title">
    <img class="logo" src="https://i.postimg.cc/NGDRjRzL/Untitled-design-removebg-preview.png" alt="Afnan Logo">
    <h1 id="title">مرحباً بك في Afnan Haute Craft</h1>
    <p class="lead">أدخل كلمة المرور للانتقال إلى الموقع. لا يمكن الوصول للمحتوى إلا لمن يملك كلمة المرور.</p>

    <label for="pw" class="sr-only">كلمة المرور</label>
    <input id="pw" type="password" autocomplete="current-password" placeholder="أدخل كلمة المرور" aria-label="كلمة المرور">

    <div>
      <button id="btn" class="btn">دخول</button>
    </div>

    <div id="msg" class="msg" aria-live="polite"></div>

    <p class="small">إذا نجحت كلمة المرور سيتم الانتقال تلقائياً إلى الموقع.</p>
  </div>

  <script>
    // --- ضبط الرابط الذي تريد التحويل إليه بعد نجاح كلمة المرور ---
    const TARGET_URL = "https://sites.google.com/view/afnantlm/";

    // --- هذا هو الـ SHA-256 المخزّن (hash لكلمة المرور الصحيحة) ---
    // تم حساب هاش كلمة المرور "Afnan@13@Zk"
    const PASSWORD_HASH = "3291efd6963fe54fe9a0cddfd1e9dc8411c2ae916e368a5ec4227a6874b102eb";

    // حظر بعد 5 محاولات (محلياً) — يمكن تغييره
    const MAX_ATTEMPTS = 5;
    const ATTEMPT_KEY = "afn_attempts_v1";

    // دالة لتحويل نص إلى SHA-256 باستخدام Web Crypto API
    async function sha256hex(message) {
      const enc = new TextEncoder();
      const data = enc.encode(message);
      const hashBuffer = await crypto.subtle.digest('SHA-256', data);
      const hashArray = Array.from(new Uint8Array(hashBuffer));
      const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
      return hashHex;
    }

    // قراءة عدد المحاولات من localStorage
    function getAttempts(){
      try { return parseInt(localStorage.getItem(ATTEMPT_KEY) || "0", 10); }
      catch(e){ return 0; }
    }
    function incAttempts(){
      const v = getAttempts() + 1;
      localStorage.setItem(ATTEMPT_KEY, v.toString());
      return v;
    }
    function resetAttempts(){ localStorage.removeItem(ATTEMPT_KEY); }

    document.getElementById('btn').addEventListener('click', async function(){
      const input = document.getElementById('pw').value || "";
      const msg = document.getElementById('msg');

      // فحص الحظر المحلي
      const attempts = getAttempts();
      if(attempts >= MAX_ATTEMPTS){
        msg.style.color = "#ffd6d6";
        msg.textContent = "تم قفل المحاولة مؤقتاً بعد تعدٍد محاولات الدخول. امسح بيانات المتصفح لإعادة المحاولة.";
        return;
      }

      // حساب الهاش للمقارنة
      try {
        const h = await sha256hex(input.trim());
        if(h === PASSWORD_HASH){
          // ناجح
          resetAttempts();
          msg.style.color = "#b7ffd6";
          msg.textContent = "تم التحقق — سيتم التحويل الآن...";
          // تأخير بسيط قبل التحويل حتى يرى المستخدم الرسالة
          setTimeout(()=>{ window.location.href = TARGET_URL; }, 800);
        } else {
          const newAttempts = incAttempts();
          msg.style.color = "#ffd6d6";
          msg.textContent = "كلمة مرور خاطئة! المحاولة " + newAttempts + " من " + MAX_ATTEMPTS + ".";
        }
      } catch(e){
        msg.style.color = "#ffd6d6";
        msg.textContent = "حدث خطأ غير متوقع. حاول مرة أخرى.";
        console.error(e);
      }
    });

    // تمكين الضغط Enter لإرسال
    document.getElementById('pw').addEventListener('keydown', function(e){
      if(e.key === 'Enter'){ document.getElementById('btn').click(); }
    });
  </script>
</body>
</html>
